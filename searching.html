<!doctype html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html class="no-js" lang="en" data-useragent="Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)">
   
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relate It</title>

    
    <meta name="description" content="Relate it: Tracks Frequently Related Items." />
    
    <meta name="author" content="Dominic Tootell" />
    <meta name="copyright" content="relate it (c) 2013-2014" />
    <link rel="shortcut icon" href="http://tootedom.github.io/related/favicon.ico" />

	<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="http://tootedom.github.io/related/stylesheets/foundation.css" />
    <script src="http://tootedom.github.io/related/javascripts/vendor/modernizr.js"></script>
</head>


  <body>
    

<!-- Nav Bar -->

  <header class="inner">

	<nav>	  
	  <div class="row">	  	
	    <div class="large-12 columns">	      
	      <div class="nav-bar right" style="padding-top: 30px">
	       <ul class="button-group">
	         <li><a href='http://tootedom.github.io/related/index.html' class="radius small button">Home</a></li>	         
	         <li><a href='http://tootedom.github.io/related/indexing/index.html' class="radius small button">Indexing</a><br/></li>
	         <li><a href='http://tootedom.github.io/related/searching/index.html' class="radius small button">Searching</a><br/></li>							 
	         <li><a href='http://tootedom.github.io/related/configuration/index.html' class="radius small button">Configuration</a></li>
	         <li><a href='http://tootedom.github.io/related/blog/index.html' class="radius small button">Blog</a></li>
	         <li><a href='http://tootedom.github.io/related/downloads.html'  class="radius small button">Downloads</a></li>         
	        </ul>
	      </div>
	      <h1><a href='https://github.com/tootedom/related'><img src="http://tootedom.github.io/related/images/relateitlogo.png"></a></h1>
	      <hr />
	    </div>
	  </div>
	</nav>	
</header>


  <!-- End Nav -->


  <!-- Main Page Content and Sidebar -->
  <section role="main">
  <div class="row">
        <div class="large-3 medium-4 columns">
      <div class="hide-for-small">
        <div class="sidebar">             
          <nav>
            <ul class="side-nav">
              
                            
               
              <li>
                <a href="http://tootedom.github.io/related/blog/blog1">Release 1.0.1</a>
                <p><p>Release 1.0.1 is a minor release that fixed a bug with the AsyncContext being closed twice.</p></p>
              </li>
                            
               
              <li>
                <a href="http://tootedom.github.io/related/blog/blog2">Release 1.0.0</a>
                <p><p>The initial release of <code>Relate it</code>. Allowing you to relate items, and find the most frequently related items.</p></p>
              </li>
              
            </ul>
          </nav>
        </div> 
      </div>
    </div>    

    <!-- Main Blog Content -->
    <div class="large-9 medium-8 columns" role="content">

    
	
	<article>
		<h2>Overview</h2>        
		<p>In the Indexing section, we saw that the related items POST document is constructed in to many small documents and stored in elasticsearch. These tiny documents contain the <code>related-with</code> field. It is this json element <code>related-with</code>, that will be used during searching, to provide faceting.<br />This faceting that allows us to say:</p>

<ul>
<li>For this id, what are the 5 top most frequently <strong>related-with</strong> ids.</li>
</ul>

<p>For example for previously indexed POST request:</p>

<pre><code>curl -H&quot;Content-Type:text/json&quot; -XPOST -v http://localhost:8080/indexing/index -d &#39;
{
   &quot;channel&quot;:&quot;de&quot;,
   &quot;site&quot;:&quot;amazon&quot;,
   &quot;items&quot;:[
      {
         &quot;id&quot;:&quot;1&quot;,
         &quot;type&quot;:&quot;map&quot;
      },
      {
         &quot;id&quot;:&quot;2&quot;,
         &quot;type&quot;:&quot;compass&quot;
      },
      {
         &quot;id&quot;:&quot;3&quot;,
         &quot;type&quot;:&quot;torch&quot;
      },
      {
         &quot;id&quot;:&quot;4&quot;,
         &quot;type&quot;:&quot;torch&quot;,
         &quot;channel&quot;:&quot;uk&quot;
      }
   ]
}&#39;</code></pre>

<p>The search web application is then called to request the frequently related items for a product (Item with id 1 in this case):</p>

<pre><code>curl -v -N http://10.0.1.29:8080/searching/frequentlyrelatedto/1</code></pre>

<p>This returns json data containing the list of items (their id’s) that are frequently related to that item:</p>

<pre><code>{
    &quot;response_time&quot;: &quot;2&quot;, 
    &quot;results&quot;: [
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;4&quot;
        }, 
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;3&quot;
        }, 
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;2&quot;
        }
    ], 
    &quot;size&quot;: &quot;3&quot;, 
    &quot;storage_response_time&quot;: &quot;0&quot;</code></pre>

<p>}</p>
	</article>
	

	

	

	

	
	<article>
		<h2>Filters</h2>        
		<p>The search functionality allows you to filter the result based on a property of the indexed document. For example, from the initial POST there was 4 related items:</p>

<pre><code>{
   &quot;channel&quot;:&quot;de&quot;,
   &quot;site&quot;:&quot;amazon&quot;,
   &quot;items&quot;:[
      {
         &quot;id&quot;:&quot;1&quot;,
         &quot;type&quot;:&quot;map&quot;
      },
      {
         &quot;id&quot;:&quot;2&quot;,
         &quot;type&quot;:&quot;compass&quot;
      },
      {
         &quot;id&quot;:&quot;3&quot;,
         &quot;type&quot;:&quot;torch&quot;
      },
      {
         &quot;id&quot;:&quot;4&quot;,
         &quot;type&quot;:&quot;torch&quot;,
         &quot;channel&quot;:&quot;uk&quot;
      }
   ]
}&#39;</code></pre>

<ul>
<li>3 of those had the property: <code>channel: de</code></li>

<li>1 of those had the property: <code>channel: uk</code></li>
</ul>

<p>The item that had overridden the <code>channel</code> property was the following (The document with id 4):</p>

<pre><code>{
    &quot;id&quot;: &quot;4&quot; ,
    &quot;date&quot;: &quot;2013-12-24T17:44:41.943Z&quot;,
    &quot;related-with&quot;: [ &quot;1&quot;,&quot;2&quot;,&quot;3&quot;],
    &quot;type&quot;: &quot;torch&quot;,
    &quot;site&quot;: &quot;amazon&quot;,
    &quot;channel&quot;: &quot;uk&quot;
}</code></pre>

<p>In the above, there are 3 extra elements that can be searched on:</p>

<ul>
<li><code>type</code></li>

<li><code>site</code></li>

<li><code>channel</code></li>
</ul>

<p>As a result you can say. Give me the frequently related products that are mostly purchased with product <strong>1</strong>, filtering the results to return only that of “tourches”, i.e. type=torch:</p>

<pre><code>curl -v -N http://10.0.1.29:8080/searching/frequentlyrelatedto/1?type=torch</code></pre>

<p>The result is:</p>

<pre><code>{
    &quot;response_time&quot;: &quot;11&quot;, 
    &quot;results&quot;: [
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;4&quot;
        }, 
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;3&quot;
        }
    ], 
    &quot;size&quot;: &quot;2&quot;, 
    &quot;storage_response_time&quot;: &quot;2&quot;
}</code></pre>

<p>You can go further and search for torches, just in <code>channel:uk</code>, which is:</p>

<pre><code>curl -v -N &quot;http://localhost:8080/searching/frequentlyrelatedto/1?type=torch&amp;channel=uk&quot;</code></pre>

<p>Handy little command line json formatter is than of python. Try:</p>

<pre><code>curl -v -N &quot;http://localhost:8080/searching/frequentlyrelatedto/1?type=torch&amp;channel=uk&quot;  | python -mjson.tool</code></pre>

<p>Which will result in just the one related item:</p>

<pre><code>{
    &quot;response_time&quot;: 3, 
    &quot;results&quot;: [
        {
            &quot;frequency&quot;: &quot;1&quot;, 
            &quot;id&quot;: &quot;4&quot;
        }
    ], 
    &quot;size&quot;: &quot;1&quot;, 
    &quot;storage_response_time&quot;: 1
}</code></pre>

<p>Currently the search result just returns the id’s of the related items, and the frequency by which it was related with the searched for item it. It <em>DOES NOT</em> return the matching document’s information.</p>

<p>The reason behind not returning the matching documents source, is that there could be literally hundreds of matching documents. An example would be the dvd <code>The Raid</code>. This could be bought many many times, and with a number of other items; and often with the same related item many times.</p>

<p>For the below related item POSTs, the dvd <code>The Raid</code>, is associated with <code>Enter the dragon</code> and <code>kick boxer</code>. It is associated with <code>kick boxer</code> twice, and therefore <code>kick boxer</code> is the most frequently related item.</p>

<p>In the backend (elasticsearch), there are two actual physical documents that represent <code>kick boxer</code>. If we are to return the matching documents for the <code>most frequently related</code>, we have to return the source of both <code>kick boxer</code> documents. Expanding this further you could quite easily have am item related to another item 100’s of times; which would mean 100’s of matching documents. It is for this reason the content of that matches are not returned.</p>

<pre><code>curl -H&quot;Content-Type:text/json&quot; -XPOST -v http://localhost:8080/indexing/index -d &#39;
{
   &quot;channel&quot;:&quot;uk&quot;,
   &quot;site&quot;:&quot;amazon&quot;,
   &quot;items&quot;:[
      {
         &quot;id&quot;:&quot;1&quot;,
         &quot;title&quot;:&quot;The Raid&quot;,
         &quot;type&quot;:&quot;dvd&quot;
      },
      {
         &quot;id&quot;:&quot;2&quot;,
         &quot;title&quot;:&quot;Enter the dragon&quot;,
         &quot;type&quot;:&quot;dvd&quot;           
      }
   ]
}&#39;

curl -H&quot;Content-Type:text/json&quot; -XPOST -v http://localhost:8080/indexing/index -d &#39;
{
   &quot;channel&quot;:&quot;uk&quot;,
   &quot;site&quot;:&quot;amazon&quot;,
   &quot;items&quot;:[
      {
         &quot;id&quot;:&quot;1&quot;,
         &quot;title&quot;:&quot;The Raid&quot;,
         &quot;type&quot;:&quot;dvd&quot;
      },
      {
         &quot;id&quot;:&quot;2&quot;,
         &quot;title&quot;:&quot;kick boxer&quot;,
         &quot;type&quot;:&quot;dvd&quot;           
      }
   ]
}&#39;

curl -H&quot;Content-Type:text/json&quot; -XPOST -v http://localhost:8080/indexing/index -d &#39;
{
   &quot;channel&quot;:&quot;uk&quot;,
   &quot;site&quot;:&quot;amazon&quot;,
   &quot;items&quot;:[
      {
         &quot;id&quot;:&quot;1&quot;,
         &quot;title&quot;:&quot;The Raid&quot;,
         &quot;type&quot;:&quot;dvd&quot;
      },
      {
         &quot;id&quot;:&quot;2&quot;,
         &quot;title&quot;:&quot;kick boxer&quot;,
         &quot;type&quot;:&quot;dvd&quot;           
      }
   ]
}&#39;</code></pre>
	</article>
	

	

	

	
	<article>
		<h2>Logging</h2>        
		<p>The indexing and searching application uses log4j2, the default log configuration is as follows. Log4j2 is used due to use of the disruptor framework to perform logging asynchronously. In order for the default logging configuration to kick in the following property is required</p>

<pre><code>-DLog4jContextSelector=&quot;org.apache.logging.log4j.core.async.AsyncLoggerContextSelector&quot;</code></pre>

<p>If you don’t like the look of the below configuration you can specify your own configuration file via:</p>

<pre><code>-Dlog4j.configurationFile=&lt;absolute path to my file&gt;</code></pre>

<p>If the below configuration looks adequate, then you can customs the configurations with the following system properties:</p>

<pre><code>-Drelated-item.searching.log.file=&lt;absolute location of file&gt;
-Drelated-item.searching.log.level=ERROR
-Drelated-item.indexing.log.file=&lt;absolute location of file&gt;
-Drelated-item.indexing.log.level=ERROR</code></pre>

<p>The defaults are “WARN” and searching.log/indexing.log either in CATALINA_BASE/logs/ or java.io.tmpdir</p>

<p>The log4j2.xml configuration files are as follows:</p>

<p><em>Searching</em></p>

<pre class="xml"><code class="xml">
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;configuration status=&quot;WARN&quot; monitorInterval=&quot;120&quot;&gt;
        &lt;appenders&gt;
            &lt;RollingRandomAccessFile name=&quot;SEARCHING&quot; fileName=&quot;${sys:related-item.searching.log.file}&quot;
                                 immediateFlush=&quot;false&quot; append=&quot;true&quot;
                                 filePattern=&quot;${sys:related-item.searching.log.file}-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;
                &lt;Policies&gt;
                    &lt;TimeBasedTriggeringPolicy /&gt;
                    &lt;SizeBasedTriggeringPolicy size=&quot;50 MB&quot;/&gt;
                &lt;/Policies&gt;
            &lt;/RollingRandomAccessFile&gt;
        &lt;/appenders&gt;
        &lt;loggers&gt;
            &lt;root level=&quot;${sys:related-item.searching.log.level}&quot; includeLocation=&quot;false&quot;&gt;
                &lt;appender-ref ref=&quot;SEARCHING&quot;/&gt;
            &lt;/root&gt;
        &lt;/loggers&gt;
    &lt;/configuration&gt;
</code></pre>

<p><em>Indexing</em></p>

<pre class="xml"><code class="xml">
    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    &lt;configuration status=&quot;WARN&quot; monitorInterval=&quot;120&quot;&gt;
        &lt;appenders&gt;
            &lt;RollingRandomAccessFile name=&quot;INDEXING&quot; fileName=&quot;${sys:related-item.indexing.log.file}&quot;
                                 immediateFlush=&quot;false&quot; append=&quot;true&quot;
                                 filePattern=&quot;${sys:related-item.indexing.log.file}-%d{yyyy-MM-dd}-%i.log.gz&quot;&gt;
                &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;
                &lt;Policies&gt;
                    &lt;TimeBasedTriggeringPolicy /&gt;
                    &lt;SizeBasedTriggeringPolicy size=&quot;50 MB&quot;/&gt;
                &lt;/Policies&gt;
            &lt;/RollingRandomAccessFile&gt;
        &lt;/appenders&gt;
        &lt;loggers&gt;
            &lt;root level=&quot;${sys:related-item.indexing.log.level}&quot; includeLocation=&quot;false&quot;&gt;
                &lt;appender-ref ref=&quot;INDEXING&quot;/&gt;
            &lt;/root&gt;
        &lt;/loggers&gt;
    &lt;/configuration&gt;
</code></pre>
	</article>
	

	

	

	
	<article>
		<h2>Indexes</h2>        
		<p>By default the indexes that are searched in elasticsearch are any index that have a name starting with <code>**relateditems-**</code>. In other words a wild card search across all dated indexes starting with <strong>relateditems-</strong></p>

<p>The prefix of the index name is controlled by the following configuration parameter. A hyphen <code>-</code>, will added to the end of the prefix, and any subsequent indexing will index documents into a dated index:</p>

<pre><code>-Drelated-item.storage.index.name.prefix</code></pre>

<p>For example with the setting:</p>

<pre><code>-Drelated-item.storage.index.name.prefix=related</code></pre>

<p>Documents will be indexed and Searching in/from indexes named: <code>related-YYYY-MM-DD</code>.</p>

<p>It is also possible to use an alias against which to perform searches, rather than performing a wild search search. (<strong>note</strong> The alias does not apply to indexing).</p>

<p>The below gives an example of the curl request used to set up an index in elasticsearch. It creates an alias <code>related</code>, which is an alias for the indexes: <code>relateditems-2013-12-23</code> and <code>relateditems-2013-12-24</code>. When <code>related</code> is used to search, the search will be performed only against those two indexes.</p>

<pre><code>curl -XPOST localhost:9200/_aliases -d &#39;
{
    &quot;actions&quot;: [
        { &quot;add&quot;: {&quot;alias&quot;: &quot;related&quot;, &quot;index&quot;: &quot;relateditems-2013-12-23&quot;} },
        { &quot;add&quot;: { &quot;alias&quot;: &quot;related&quot;,&quot;index&quot;: &quot;relateditems-2013-12-24&quot;} }
    ]
}&#39;</code></pre>

<p>To tell the Search Web Application to use that alias, instead of the wildcard index search, you specify the alias name using the following parameter:</p>

<pre><code>-Drelated-item.storage.index.name.alias=related</code></pre>
	</article>
	

	

	

	
	<article>
		<h2>Aliases</h2>        
		<p>An alias can give you added flexibility over the content that is being searched. However, this comes at the cost of added complexity from having to maintain the alias.</p>

<p>An example usage for an alias could be the following. Imagine one day you are having a promotion for a new selection of products. You could choose to promote those products against a selection of other products. One way to do this is to re-associate the alias to a prepared index of those products and the associated items:</p>

<pre><code>curl -XPOST localhost:9200/_aliases -d &#39;
{
    &quot;actions&quot;: [
        { &quot;add&quot; :   { &quot;alias&quot; : &quot;related&quot;, &quot;index&quot;: &quot;promotion-2013-12-25&quot;   } },
        { &quot;remove&quot;: { &quot;alias&quot; : &quot;related&quot;, &quot;index&quot;: &quot;relateditems-2013-12-23&quot;} },
        { &quot;remove&quot;: { &quot;alias&quot; : &quot;related&quot;, &quot;index&quot;: &quot;relateditems-2013-12-24&quot;} }
    ]
}&#39;</code></pre>

<p>The above removes the existing mappings and creates the new mapping. This can be done a runtime, without starting either elasticsearch or the searching application. However, the downside here is the maintenance of the alias.</p>

<p>The alias cannot use a wildcard, and it needs to point to a valid index that exists. Therefore, a maintenance script needs to create that would periodically run to update the alias mapping to point to new indexes.</p>

<p>Unfortunately at the moment support for assigning index alias’s at index creation time does not currently exist (https://github.com/elasticsearch/elasticsearch/pull/2739 and https://github.com/elasticsearch/elasticsearch/issues/4920).</p>

<p>For more information about index alias in elasticsearch please read:</p>

<pre><code>http://www.elasticsearch.org/blog/changing-mapping-with-zero-downtime/</code></pre>
	</article>
	

	

	

	

	

	

	

	

	

	

	

	

	



<!--       <article>

        <h3><a href="#">Blog Post Title</a></h3>
        <h6>Written by <a href="#">John Smith</a> on August 12, 2012.</h6>

        <div class="row">
          <div class="large-6 columns">
            <p>Bacon ipsum dolor sit amet nulla ham qui sint exercitation eiusmod commodo, chuck duis velit. Aute in reprehenderit, dolore aliqua non est magna in labore pig pork biltong. Eiusmod swine spare ribs reprehenderit culpa.</p>
            <p>Boudin aliqua adipisicing rump corned beef. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>
          </div>
          <div class="large-6 columns">
            <img src="http://placehold.it/400x240&text=[img]" />
          </div>
        </div>

        <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon nulla pork belly cupidatat meatloaf cow. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>

        <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon nulla pork belly cupidatat meatloaf cow. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>

      </article>

      <hr />

      <article>

        <h3><a href="#">Blog Post Title</a></h3>
        <h6>Written by <a href="#">John Smith</a> on August 12, 2012.</h6>

        <div class="row">
          <div class="large-6 columns">
            <p>Bacon ipsum dolor sit amet nulla ham qui sint exercitation eiusmod commodo, chuck duis velit. Aute in reprehenderit, dolore aliqua non est magna in labore pig pork biltong. Eiusmod swine spare ribs reprehenderit culpa.</p>
            <p>Boudin aliqua adipisicing rump corned beef. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>
          </div>
          <div class="large-6 columns">
            <img src="http://placehold.it/400x240&text=[img]" />
          </div>
        </div>

        <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon nulla pork belly cupidatat meatloaf cow. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>

        <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon nulla pork belly cupidatat meatloaf cow. Nulla corned beef sunt ball tip, qui bresaola enim jowl. Capicola short ribs minim salami nulla nostrud pastrami.</p>

      </article> -->

    </div>

    <!-- End Main Content -->


    <!-- Sidebar -->

<!--     <aside class="large-3 columns">

      <h5>Categories</h5>
      <ul class="side-nav">
        <li><a href="#">News</a></li>
        <li><a href="#">Code</a></li>
        <li><a href="#">Design</a></li>
        <li><a href="#">Fun</a></li>
        <li><a href="#">Weasels</a></li>
      </ul>

      <div class="panel">
        <h5>Featured</h5>
        <p>Pork drumstick turkey fugiat. Tri-tip elit turducken pork chop in. Swine short ribs meatball irure bacon nulla pork belly cupidatat meatloaf cow.</p>
        <a href="#">Read More &rarr;</a>
      </div>

    </aside> -->

    <!-- End Sidebar -->
  </div>

  <!-- End Main Content and Sidebar -->


  <!-- Footer -->
  <footer class="row">
    <div class="large-12 columns">
      <hr />
      <div class="row">
        <div class="large-6 columns">
          <p class="copyright">&copy; relate it maintained by <a href="https://github.com/tootedom">tootedom</a></p>
        </div>
        <div class="large-6 columns">
          <ul class="inline-list right">
            <li><a href="https://github.com/tootedom/related"><i class="fa fa-github"></i> Relate it (Source)</a></li>
            <li><address><a href="mailto:dominic.tootell@relateit.io"><i class="fa fa-envelope"></i> Dominic Tootell</a></address></li>
            <li><a href="https://twitter.com/tootedom"><i class="fa fa-twitter"></i>@tootedom</a></li>
          </ul>
        </div>
      </div>
    </div>
</footer>
<script src="http://tootedom.github.io/related/javascripts/vendor/jquery.js"></script>
<script src="http://tootedom.github.io/related/javascripts/foundation/foundation.js"></script>
<script src="http://tootedom.github.io/related/javascripts/foundation/foundation.dropdown.js"></script>
<script src="http://tootedom.github.io/related/javascripts/foundation/foundation.magellan.js"></script>
<script>
      $(document).foundation({
        // specify the class used for active dropdowns
        active_class: 'open'
      });

      var doc = document.documentElement;
      doc.setAttribute('data-useragent', navigator.userAgent);
</script>

  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-47714522-1");
            pageTracker._trackPageview();
            } catch(err) {}
</script>
  </section>
  </body>
</html>